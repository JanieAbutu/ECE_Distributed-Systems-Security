
# Player Entity - REST API Documentation
This document describes the design, implementation of the Player Entity using Node.js, Express, MongoDB, and Mongoose.
The Player Entity is connected to a Team through a relational identifier(teamId) and uses both CRUD operations and relational-based queries.

## Player Resource Description
Each player contains the following fields:

| Field    | Type       | Description 
|-------   |------------|----------
| id       | ObjectId   | Unique identifier generated by MongoDB 
| teamid   | ObjectId   | Identifier of the team the player belongs to
| name     | String     | Player name
| number   | Number     | Jersey number
| position | String     | Playing position

## Architecture Overview
The architecture used by Player entity ensures scalability, readability, easy maintenance, and consistency

models/        -> Data schema
controllers/   -> Business logic
routes/        -> HTTP routing
index.js       -> Application entry point

## Project Structure

project/
│
├── models/
│   ├─ Equipe.js              # Team schema
│   ├─ Player.js              # Player schema
│   └─ User.js                # User model for authentication
│
├── routes/
│   ├─ equipes.js             # Team routes
│   ├─ players.js             # Player routes
│   └─ auth.js                # Login/signup routes
│
├── controllers/
│   ├─ Equipe.js              # Team logic
│   ├─ playerController.js    # Player logic
│   └─ authController.js      # Login/signup logic
│
├── middleware/
│   └── auth.js               # JWT verification middleware
│
├── index.js                   # Entry point
└── package.json               # Dependencies


## Player Data Model
The Player model defines the structure of the Player collection in MongoDB as seen in:
- models/player.js

### What it does
- Define Player attributes
- Enforce required fields
- Reference a team using teamid

### Key design decision:
- teamid is stored as an ObjectId to enable relationship queries.

## Player Controller
The controller contains all application logic related to players as seen in:
- controllers/playerscontroller.js

### What it does:
- Handle database interactions
- Process request data
- Return appropriate HTTP responses

## CRUD Operations (4 requests)
### 1. **Create a Player**
- Endpoint is POST /players

#### What it does:
- Validates request body
- Saves a new player in the database

### 2. **Retrieve Player by ID**
- Endpoint is GET /players/:id

#### What it does:
- Returns one specific player

### 3. **Update Player**
- Endpoint is PUT /players/:id

#### What it does:
- Updates an existing player using its ID

### 4. **Delete Player**
- Endpoint is DELETE /players/:id

#### What it does:
-  Deletes a player from the database

## Relationship-Based Routes
### 1. Display Players of a Team
- Endpoint is GET /players/team/:teamId

#### What it does:
-  Displays all players of a given team

### 2. Display the Team of a Player
- Endpoint is GET /players/player/:id/team

#### What it does:
-  Retrieve the team information for a player

### 3. Search Players by Name
- Endpoint is GET /players/search/name?name=value

#### What it does:
-  Name-based search using partial and case-insensitive matching.

## Player Routes Registration
Routing file is routes/players.js

- Maps HTTP methods to controller functions
- Keeps routing logic separate from business logic

## JWT Authentication
- Protects routes by verifying the JWT token in the Authorization header.

## Integration into Application
Integrated via the file *index.js*

The Player routes are registered as /players

## Setup Instructions

### Install dependencies
#### Dependencies:
- express – HTTP server
- mongoose – MongoDB ORM

### Start MongoDB
- Ensure MongoDB is running on your machine (default: mongodb://127.0.0.1:27017)
- Database: teamsdb
You can use MongoDB Compass or mongosh to check.

- Import initial data via MongoDB Compass → Collection → Import JSON.

### Start the Server
- Start the Server
Server runs on: http://127.0.0.1:82/


## Testing the API Without Authentication
The Player API was tested using **Postman** in the order:
- Create a new collection in Postman
- Add requests for each endpoint using HTTP method + URL:
- - GET http://127.0.0.1:82/equipes
- - POST http://127.0.0.1:82/equipes
- - PUT http://127.0.0.1:82/equipes/:id
- - DELETE http://127.0.0.1:82/equipes/:id

- - GET http://127.0.0.1:82/players
- - POST http://127.0.0.1:82/players
- - POST http://127.0.0.1:82/players/bulk
- - GET http://127.0.0.1:82/players/:id
- - PUT http://127.0.0.1:82/players/:id
- - DELETE http://127.0.0.1:82/players/:id
- - GET http://127.0.0.1:82/players/team/:teamId
- - GET http://127.0.0.1:82/players/:id/team
- - GET http://127.0.0.1:82/players/search/:name

- For POST/PUT, use Body → raw → JSON:



## Testing the API With Authentication
- Add requests for each endpoint using HTTP method + URL:

- - POST http://127.0.0.1:82/auth/signup -> create user (password hashed)
- - POST http://127.0.0.1:82/auth/login  -> login, returns JWT
- - GET http://127.0.0.1:82/players      ->list all players
- - POST http://127.0.0.1:82/players -> create one player
- - POST http://127.0.0.1:82/players/bulk -> create multiple players
- - PUT http://127.0.0.1:82/players/:id   -> update player
- - DELETE http://127.0.0.1:82/players/:id ->delete player

**-Protected routes require JWT token in header:**
Key: Authorization
Value: Bearer <TOKEN>


## Things to note:
1. Use MongoDB ObjectId references to link players to teams.
2. Passwords are hashed using bcrypt.
3. JWT tokens are valid for 24h.
4. Add auth middleware to protect write routes (POST, PUT, DELETE).